<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercices sur les Identités Remarquables</title>
    <script>
        // Configuration MathJax pour les formules en LaTeX
        window.MathJax = {
            loader: { load: ['input/tex', 'output/chtml'] },
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']],
                processEscapes: true,
                packages: {'[+]': ['ams']}
            },
            startup: {
                ready: () => {
                    MathJax.startup.defaultReady();
                    MathJax.startup.promise.then(() => {
                        console.log('MathJax chargé');
                    });
                }
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f9;
            color: #333;
            padding: 20px;
            text-align: center;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #007bff;
            margin-bottom: 30px;
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }
        button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #218838;
        }
        .section-header {
            background-color: #007bff;
            color: white;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px 5px 0 0;
            font-size: 1.2em;
        }
        .exercice-section {
            border: 1px solid #ddd;
            margin-bottom: 25px;
            border-radius: 10px;
            padding-bottom: 15px;
            background-color: #f9f9f9;
        }
        .problem {
            font-size: 1.4em;
            margin: 20px 0;
            padding: 0 15px;
        }
        .solution {
            margin: 10px 15px;
            padding: 15px;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            text-align: left;
            font-size: 1.1em;
            display: none; /* Caché par défaut */
        }
        .solution p {
            margin: 5px 0;
        }
        .hint-container {
            margin-top: 15px;
        }
        .hint {
            margin: 5px 15px;
            padding: 10px;
            background-color: #ffeeba;
            border: 1px solid #ffc107;
            border-radius: 5px;
            text-align: left;
            font-style: italic;
            font-size: 0.95em;
            display: none;
        }
        .action-buttons {
            margin: 15px 0;
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .action-buttons button {
            padding: 8px 15px;
            font-size: 0.9em;
        }
        .hint-button {
            background-color: #ffc107;
            color: #333;
        }
        .hint-button:hover {
            background-color: #e0a800;
        }
        .solution-button {
            background-color: #dc3545;
        }
        .solution-button:hover {
            background-color: #c82333;
        }
        /* Style spécifique pour le bouton droits d'auteur */
        #copyright-btn {
            background-color: #6c757d; /* Gris */
        }
        #copyright-btn:hover {
            background-color: #5a6268;
        }
        /* Style pour le contenu des droits d'auteur, utilisant la classe .solution pour l'apparence */
        #copyright-content {
            margin-bottom: 30px;
        }
        #copyright-content h3 {
            color: #6c757d;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Générateur d'Exercices : Identités Remarquables</h1>

        <div class="controls">
            <button onclick="generateExercises()">Nouveaux Exercices</button>
            <button onclick="toggleAllSolutions(this)" class="solution-button">Afficher/Masquer Toutes les Solutions</button>
            <button id="copyright-btn">⚖️ Droits d'auteur</button>
        </div>
        
        <div id="copyright-content" class="solution">
            <h3>⚖️ Droits d'Auteur et Licence d'Utilisation</h3>
            <p><strong>Auteur :</strong> Yann Merdy (yann.merdy@gmail.com) - Novembre 2025</p>
            <p><strong>Licence d'Utilisation Non Commerciale</strong></p>
            <p>Ce code HTML/CSS/JavaScript ainsi que le contenu généré par l'application ("Cours et Exercices Dynamiques : Le Produit Scalaire") sont la propriété intellectuelle exclusive de l'auteur, Yann Merdy.</p>
            
            <h4>Conditions :</h4>
            <ul>
                <li><strong>Utilisation Privée et Éducative (Autorisée) :</strong> Vous êtes autorisé.e à utiliser, copier, modifier et distribuer ce code et son contenu **uniquement** à des fins **personnelles, éducatives et non lucratives.**</li>
                <li><strong>Utilisation Commerciale (Interdite) :</strong> Toute utilisation, distribution, intégration ou reproduction du code ou du contenu (total ou partiel) à des fins **commerciales, lucratives ou professionnelles** est **strictement interdite** sans un accord écrit préalable et explicite de l'auteur.</li>
                <li><strong>Attribution :</strong> Toute reproduction ou modification doit conserver la mention de l'auteur originale (Yann Merdy) et la présente notice de droits d'auteur.</li>
            </ul>
            <p>Pour toute demande d'utilisation commerciale ou de licence spécifique, veuillez contacter l'auteur à l'adresse indiquée ci-dessus.</p>
        </div>
        
        <div id="exercices-container">
            </div>
    </div>

    <script>
        // Variables pour les identités remarquables
        const identites = [
            { id: 1, type: "Développement", forme: "(a+b)²", developpe: "a² + 2ab + b²", fn: (a, b) => `\\( (${a}x + ${b})^2 \\)`, sol: (a, b) => `\\( ${a*a}x^2 + ${2*a*b}x + ${b*b} \\)` },
            { id: 2, type: "Développement", forme: "(a-b)²", developpe: "a² - 2ab + b²", fn: (a, b) => `\\( (${a}x - ${b})^2 \\)`, sol: (a, b) => `\\( ${a*a}x^2 - ${2*a*b}x + ${b*b} \\)` },
            { id: 3, type: "Développement", forme: "(a-b)(a+b)", developpe: "a² - b²", fn: (a, b) => `\\( (${a}x - ${b})(${a}x + ${b}) \\)`, sol: (a, b) => `\\( ${a*a}x^2 - ${b*b} \\)` },
            { id: 4, type: "Factorisation", forme: "a² + 2ab + b²", factorise: "(a+b)²", fn: (a, b) => `\\( ${a*a}x^2 + ${2*a*b}x + ${b*b} \\)`, sol: (a, b) => `\\( (${a}x + ${b})^2 \\)` },
            { id: 5, type: "Factorisation", forme: "a² - 2ab + b²", factorise: "(a-b)²", fn: (a, b) => `\\( ${a*a}x^2 - ${2*a*b}x + ${b*b} \\)`, sol: (a, b) => `\\( (${a}x - ${b})^2 \\)` },
            { id: 6, type: "Factorisation", forme: "a² - b²", factorise: "(a-b)(a+b)", fn: (a, b) => `\\( ${a*a}x^2 - ${b*b} \\)`, sol: (a, b) => `\\( (${a}x - ${b})(${a}x + ${b}) \\)` }
        ];

        // Fonction pour générer un nombre aléatoire entre min et max (inclus)
        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // Génère les exercices pour les 3 types
        function generateExercises() {
            const container = document.getElementById('exercices-container');
            container.innerHTML = '';
            
            // Masquer les droits d'auteur si affichés
            document.getElementById('copyright-content').style.display = 'none';

            // Les identités à développer
            generateSection(container, "Développement", [1, 2, 3], 2); // 2 exos de développement
            
            // Les identités à factoriser
            generateSection(container, "Factorisation", [4, 5, 6], 2); // 2 exos de factorisation
        }

        // Génère une section d'exercices
        function generateSection(parentContainer, sectionName, ids, count) {
            const sectionDiv = document.createElement('div');
            sectionDiv.className = 'exercice-section';
            sectionDiv.id = `section-${sectionName}`;
            
            sectionDiv.innerHTML = `<div class="section-header">${sectionName}</div>`;
            
            for (let i = 0; i < count; i++) {
                const randomId = ids[getRandomInt(0, ids.length - 1)];
                const ir = identites.find(item => item.id === randomId);
                
                // Générer des nombres aléatoires pour a et b
                const a = getRandomInt(2, 5);
                const b = getRandomInt(1, 6); 
                
                const problemLatex = ir.fn(a, b);
                const solutionLatex = ir.sol(a, b);
                
                // Pistes d'aide pour l'utilisateur
                const hints = [
                    `Ceci est une identité remarquable de type : **${ir.forme}**`,
                    `Rappelez-vous la formule : **${ir.developpe || ir.factorise}**`,
                    `Identifiez **a** et **b** : dans ce cas, \\( a = ${a}x \\) et \\( b = ${b} \\).`
                ];

                const exerciceHtml = createExerciceHtml(sectionName, i, problemLatex, solutionLatex, hints);
                sectionDiv.innerHTML += exerciceHtml;
            }

            parentContainer.appendChild(sectionDiv);
             
             // Relancer MathJax sur la section pour le rendu initial
             if (typeof MathJax !== 'undefined') {
                 MathJax.typesetPromise([sectionDiv]);
             }
        }
        
        // Crée la structure HTML d'un exercice
        function createExerciceHtml(sectionName, index, problemLatex, solutionLatex, hints) {
            const num = index + 1;
            const uniqueId = `${sectionName.toLowerCase()}-${num}`;
            
            let hintsHtml = '<div class="hint-container">';
            hints.forEach((hint, idx) => {
                hintsHtml += `<div id="${uniqueId}-hint-${idx}" class="hint">${hint}</div>`;
            });
            hintsHtml += '</div>';
            
            return `
                <div class="problem">
                    **Exercice ${num}** : ${problemLatex}
                </div>
                <div class="action-buttons">
                    <button class="hint-button" onclick="showNextHint('${sectionName}', ${index}, ${hints.length})">Piste (${hints.length} max)</button>
                    <button class="solution-button" onclick="toggleSolution('${uniqueId}-solution')">Solution</button>
                </div>
                ${hintsHtml}
                <div id="${uniqueId}-solution" class="solution">
                    **Solution :** ${solutionLatex}
                </div>
            `;
        }

        // Affiche la piste suivante pour un exercice
        function showNextHint(sectionName, index, totalHints) {
            const section = document.getElementById(`section-${sectionName}`);
            const solutionDiv = section.querySelector(`#${sectionName.toLowerCase()}-${index+1}-solution`);

            // Récupérer l'index de la dernière piste affichée (ou -1 si aucune)
            let currentHintIndex = -1;
            for (let i = 0; i < totalHints; i++) {
                const hint = section.querySelector(`#${sectionName.toLowerCase()}-${index+1}-hint-${i}`);
                if (hint && hint.style.display === 'block') {
                    currentHintIndex = i;
                }
            }
            
            const nextHintIndex = currentHintIndex + 1;
            const nextHintId = `${sectionName.toLowerCase()}-${index+1}-hint-${nextHintIndex}`;
            const nextHintElement = document.getElementById(nextHintId);

            if (nextHintElement) {
                nextHintElement.style.display = 'block';
            }

            // Cacher le bouton "Piste" si toutes les pistes sont affichées
            if (currentHintIndex + 1 >= totalHints) {
                const button = section.querySelector(`#section-${sectionName} .action-buttons:nth-child(${index * 3 + 3}) .hint-button`);
                if (button) {
                     button.style.display = 'none';
                }
            }
             
             // Relancer MathJax sur la section pour rendre les éventuelles formules LaTeX dans l'aide
             if (typeof MathJax !== 'undefined' && nextHintElement) {
                 // On ne demande le rendu que de l'élément d'aide qui vient d'apparaître pour optimiser
                 MathJax.typesetPromise([nextHintElement]); 
             } 
        }

        // Affiche/Masque la solution d'un exercice
        function toggleSolution(solutionId) {
            const sol = document.getElementById(solutionId);
            const isHidden = sol.style.display === 'none' || sol.style.display === '';
            sol.style.display = isHidden ? 'block' : 'none';
            
             // Si on vient d'afficher la solution, on demande à MathJax de la rendre
             if (sol.style.display === 'block' && typeof MathJax !== 'undefined') {
                 MathJax.typesetPromise([sol]); 
             }
        }
        
        // Affiche/Masque toutes les solutions
        function toggleAllSolutions(button) {
            // Cacher les droits d'auteur si affichés
            document.getElementById('copyright-content').style.display = 'none';
            
            const solutions = document.querySelectorAll('.exercice-section .solution');
            const show = solutions[0] && (solutions[0].style.display === 'none' || solutions[0].style.display === '');
            
            solutions.forEach(sol => {
                sol.style.display = show ? 'block' : 'none';
            });
             
             // Si on vient d'afficher les solutions, on demande à MathJax de les rendre
             if (show && typeof MathJax !== 'undefined') {
                 MathJax.typesetPromise(solutions); 
             }
        }
        
        // Fonction pour afficher/masquer le contenu des droits d'auteur
        function toggleCopyright() {
            const copyrightDiv = document.getElementById('copyright-content');
            const isHidden = copyrightDiv.style.display === 'none' || copyrightDiv.style.display === '';
            copyrightDiv.style.display = isHidden ? 'block' : 'none';
            
            // Masquer les exercices si les droits d'auteur sont affichés (optionnel, pour dégager la vue)
            document.getElementById('exercices-container').style.display = isHidden ? 'none' : 'block';
        }


        // --- INITIALISATION ET ÉVÉNEMENTS ---

        // Générer le premier exercice au chargement initial de la page
        document.addEventListener('DOMContentLoaded', () => {
            // Événement pour le bouton Droits d'Auteur
            document.getElementById('copyright-btn').addEventListener('click', toggleCopyright);
            
            // S'assurer que le contenu des droits d'auteur est masqué au départ
            document.getElementById('copyright-content').style.display = 'none';
            
            generateExercises(); 
        });
    </script>

</body>
</html>
